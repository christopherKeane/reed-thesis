\documentclass[12pt,twoside]{reedthesis}
\usepackage{graphicx,latexsym, caption, subcaption} 
\usepackage{amssymb,amsthm,amsmath,mathrsfs,mathtools}
\usepackage{longtable,booktabs,setspace} 
\usepackage[hyphens]{url}
\usepackage{rotating}
\usepackage{enumitem}
\usepackage{tikz, tikz-cd}
\usepackage{adjustbox}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem*{definition*}{Definition}
\newtheorem{exercise}{Exercise}

\theoremstyle{remark}
\newtheorem{remark}{Remark}[section]
\newtheorem{example}{Example}[section]

\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\Bl}{\operatorname{Bl}}
\newcommand{\Affine}{\mathbb{A}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\sheafF}{\mathcal{F}}
\newcommand{\sheafG}{\mathcal{G}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\Proj}{\mathbb{P}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calA}{\mathcal{A}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\calM}{\mathcal{M}}
\newcommand{\kbar}{\overline{k}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\dom}{\operatorname{dom}}
\newcommand{\Frac}{\operatorname{Frac}}
\newcommand{\codim}{\operatorname{codim}}
\newcommand{\Div}{\operatorname{Div}}
\newcommand{\Cl}{\operatorname{Cl}}
\newcommand{\Fr}{\operatorname{Fr}}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\Br}{\operatorname{Br}}
\newcommand{\Pic}{\operatorname{Pic}}
\renewcommand{\div}{\operatorname{div}}
\newcommand*{\sheafhom}{\mathscr{H}\kern -.5pt om}
\newcommand{\Az}{\operatorname{Az}}
\newcommand{\adele}{\reflectbox{$\Affine$}}
\newcommand{\ev}{\operatorname{ev}}
\newcommand{\inv}{\operatorname{inv}}
\newcommand{\op}{^{\text{op}}}
\newcommand{\Gal}{\operatorname{Gal}}
\newcommand{\NS}{\operatorname{NS}}
\newcommand{\Num}{\operatorname{Num}}
\newcommand{\disc}{\operatorname{disc}}
\newcommand{\GG}{\mathfrak{G}}


\title{Arithmetic Computations on K3 Surfaces}
\author{Christopher Keane}

\date{May 2017}
\division{Mathematics and Natural Sciences}
\advisor{Mckenzie West}

\department{Mathematics}

\setlength{\parskip}{0pt}

\begin{document}

%\maketitle
%\frontmatter 
%\pagestyle{empty} 
\tableofcontents
%\chapter*{Abstract}
%Well, here's some math.	
\mainmatter 
\pagestyle{fancyplain} 

\chapter{Geometry of surfaces}
In this chapter we introduce some general facts from modern algebraic geometry, and basic results of surface theory. Our goal is to develop some familiarity with the language of modern algebraic geometry and introduce the invariants most commonly used to study surfaces and their rational points.

\section{Properties of varieties}
In general, a \emph{variety} can be thought of as the set of solutions to some number of polynomial equations defined over some field. Historically, the study of such objects had roots in algebra and geometry. In order to obtain useful information about a variety, it is helpful to also consider the variety's corresponding coordinate ring equipped with the Zariski topology. This allows one to bring the vast theory of commutative algebra to bear on geometric questions. With the development of category theory, mathematicians like Alexander Grothendieck and Jean-Pierre Serre saw fit to reformulate the theory of algebraic geometry using category theory, giving rise to the language of schemes. This shifted the fundamental object of the field from sets of solutions to equations to topological spaces equipped with sheaves. The techniques developed by Grothendieck and Serre lead to the solutions of several long unsolved geometric problems, and so many mathematicians decided to follow their lead and learn this new, highly abstract theory. The language of schemes is ubiquitous in the modern study of geometry, it is the language we will be using throughout this thesis to talk about varieties.
\begin{definition}
For a fixed scheme $S$, a \emph{scheme over $S$} is a scheme $X$ along with a morphism $X\to S$ called the structure morphism of $X$. In this case, we may refer to $X$ as an $S$-scheme. If we have two $S$-schemes $X$ and $Y$, then an $S$-morphism from $X$ to $Y$ is a morphism $X\to Y$ that is compatible with the structure morphisms of $X$ and $Y$.\label{schemeOverDef}
\end{definition}
\noindent If we speak about an algebraic object as a scheme, we are referring to that object's spectrum of prime ideals. For example, if $X$ is a scheme, $A$ is a commutative ring, and we refer to a morphism $X\to A$, we mean to speak about a morphism $X\to\Spec A$. Similarly, if we define $X$ to be an $A$-scheme, the structure morphism goes from $X$ to $\Spec A$. Many of the definitions in this thesis will be stated for general schemes as above, although the objects of interest are not general schemes but varieties.
\begin{definition}
A \emph{variety} is a separated scheme of finite type over a field $k$. \label{varDef}
\end{definition}
This definition of variety is more general than the classical notion, which involves quasiprojective varieties. The class of quasiprojective varieties is large, but the language of schemes allows for slightly more generality. The varieties defined here locally look quasiprojective, but globally may not have any sort of natural projective embedding. We will sometimes refer to a variety $X$ as an ordered pair $(X,\calO_X)$, where $X$ denotes the underlying topological space of the scheme, and $\calO_X$ denotes the structure sheaf of $X$. 

Our goal with this chapter is to move towards discussing rational points on varieties. In doing so, we need to introduce the concept of base extension.
\begin{definition}
Let $S$ be a scheme, and suppose that $X$ and $Y$ are $S$-schemes. The \emph{fiber product} $X\times_S Y$ of $X$ and $Y$ over $S$ is a scheme along with morphisms $p_1:X\times_S Y\to X, p_2:X\times_S Y\to Y$ such that the diagram in Fig.~\ref{fibDiag} commutes. Furthermore, if there is a scheme $Z$ and morphisms $\varphi:Z\to X, \eta:Z\to Y$ making the diagram commute, then there is a unique $\theta:Z\to X\times_S Y$ such that $\varphi=p_1\circ\theta$ and $\eta=p_2\circ\theta$. Lastly, if we have schemes $X$ and $Y$ without referencing a base scheme $S$, then we define the product $X\times Y$ to be $X\times_{\Spec\ZZ} Y$, since any scheme admits a morphism to $\Spec\ZZ$.
\begin{figure}[h]
\centering
\begin{tikzcd}
Z\arrow[bend left]{drr}{\varphi} \arrow[bend right]{ddr}{\eta} \arrow[dotted]{dr}{\exists!\theta} & &\\
& X\times_S Y \arrow{d}{p_2} \arrow{r}{p_1} & X \arrow{d}{f_X} \\
& Y \arrow{r}{f_Y} & S
\end{tikzcd}
\caption{A commutative diagram describing the fiber product. Here, $f_Y$ and $f_X$ denote the structure morphisms as in Def.~\ref{schemeOverDef}.}
\label{fibDiag}
\end{figure}
\end{definition}
\begin{theorem}
For schemes $X,Y$ defined over a scheme $S$, the fiber product $X\times_S Y$ exists and is unique up to unique isomorphism
\end{theorem}
\begin{proof}
See \cite{hartshorne}, Ch. II, Theorem 3.3.
\end{proof}
With this definition and existence in hand, we present some uses of the fiber product.
\begin{definition}
Let $f:X\to Y$ be a morphism of schemes, $y\in Y$ a point, and let $k(y)$ denote the residue field of $y$. Then we define the \emph{fiber of $f$ over $y$} to be $X_y=X\times_Y\Spec(k(y))$. This definition makes sense, since we have a natural map $\Spec(k(y))\hookrightarrow Y$. The fiber $X_y$ is a $k(y)$-scheme, and its topological space is homeomorphic to $f^{-1}(y)\subseteq X$.
\end{definition}
\noindent The most common usage of this notion of fiber occurs when we have a scheme $X$ defined over some commutative ring $A$, and want to consider the fiber over some prime ideal $\mathfrak{p}\in\Spec A$. In this case, the fiber $X_\mathfrak{p}$ is called the \emph{reduction of $X$ mod $\mathfrak{p}$}. 

Perhaps the most relevant application of the fiber product for this thesis is base extension. We will be looking at equations defined over $\QQ$, but will also want to consider all possible solutions to those equations by looking to extensions of $\QQ$.
\begin{definition}
For a variety $X$ defined over a field $k$, and a field extension $L$ of $k$, we define $X_L=X\times_k L$ to be the \emph{base extension} of $X$ by $L$.
\end{definition}
\noindent In practice, we perform base extension simply by considering the defining equations of $X$ to be defined over $L$ rather than over $k$. Importantly, we note that base extension may change some properties of $X$ as a scheme.

\begin{example}
Let $X$ be the variety defined by the equation $x^2-2y^2=0$ over $\QQ$. This $X$ is both irreducible and integral, since $x^2-2y^2$ is irreducible over $\QQ[x,y]$. But, the extension $X_{\overline{\QQ}}$ of $X$ by $\overline{\QQ}$ is not irreducible, since $X_{\overline{\QQ}}$ is the union of the lines $x-\sqrt{2}y=0, x+\sqrt{2}y=0$.
\end{example}

\begin{definition}
If we have some property $P$ and a $k$-variety $X$, then we say that $X$ is \emph{geometrically} $P$ if $P$ holds for the extension $X_{\overline{k}}$ of $X$ by some algebraic closure $\overline{k}$ of $k$.
\end{definition}
\noindent Letting $X$ be as in the previous example, we have that $X$ is irreducible but not geometrically irreducible.

\section{Divisors}
In this section we assume throughout that $X$ is an noetherian, integral variety that is regular in codimenison one. By regular in codimension one, we mean that for every $x\in X$ such that $\calO_{X,x}$ has Krull dimension one, $\calO_{X,x}$ is regular.

\begin{definition}
A \emph{prime divisor} on $X$ is a closed integral subvariety of codimension one. A \emph{Weil divisor} is an element of the free abelian group $\Div X$ generated by the prime divisors. 
\end{definition}
A divisor $D$ is written as a formal linear combination $D=\sum n_i Y_i$, where the sum runs over all prime divisors, each $n_i\in\ZZ$, and only finitely many of the $n_i$ are nonzero. If each $n_i\geq 0$, then we say that $D$ is effective. This way of expressing divisors allows for a natural partial order to be put on $\Div X$. Indeed, if we have $D_1=\sum n_i Y_i, D_2=\sum m_i Y_i$, then we say $D_1\leq D_2$ if and only if we have $n_i\leq m_i$ for all $i$.

For $Y$ a prime divisor on $X$, suppose that $\eta$ is the generic point of $Y$. Then the local ring $\calO_{\eta, X}$ is a discrete valuation ring, and its field of fractions is equal to the function field of the variety $X$. From these local rings, we obtain valuations $v_Y$ for each prime divisor $Y$. For a nonzero  rational function $f$ on $X$, we have $v_Y(f)\in\ZZ$ for all prime divisors $Y$. If $v_Y(f)>0$, we say that $f$ has a \emph{zero} along $Y$, and if $v_Y(f)<0$, we say that $f$ has a \emph{pole} along $Y$.

\begin{definition}
Let $f$ be a nonzero rational function on $X$. The \emph{divisor} of $f$, $\div(f)$ is given by $\div(f)=\sum v_Y(f)\cdot Y$, with the sum ranging over all prime divisors $Y$. A divisor $D\in\Div X$ is \emph{principal} if there is some rational function $f$ on $X$ such that $D=\div(f)$. The set of principal divisors forms a subgroup of $\Div X$.
\end{definition}

\noindent The assignment $f\mapsto\div(f)$ is a group homomorphism from the group of nonzero rational functions $K^*$ on $X$ to $\Div X$. 

\begin{remark}\label{divSpace}
Suppose that $X$ is a $k$-variety. It is often useful to be able to think about the set of all divisors that share some common properties with a fixed divisor $D$ on $X$. To do this, we define \[\mathcal{L}(D)=\{f\in K^\times: \div(f)\geq -D\}\cup\{0\},\] where $K$ denotes the function field of $X$. This is called the \emph{Riemann-Roch space} of $D$, and it is a vector space over $k$. From each of these vector spaces, we note that we can obtain a corresponding sheaf $\mathcal{L}_D$ as follows. Since $D$ is defined on $X$, we can restrict $D$ to any open set $U\subseteq X$ and obtain a divisor $D|_U$ on $U$. For each regular function $g\in\calO_X(U)$ and $f\in\mathcal{L}(D)$, we note that $fg\in\mathcal{L}(D)$, since the regularity of $g$ implies $g\geq0$. This multiplication gives $\mathcal{L}(D)$ a module structure, and in fact gives rise to an isomorphism between $\mathcal{L}(D)$ and $\calO_X(U)$. This isomorphism and module structure is enough for us to conclude that the vector space $\mathcal{L}(D)$ can also be viewed as a sheaf.
\end{remark}

\begin{definition}
For two divisors $D,D'$ on $X$, we say that $D$ and $D'$ are \emph{linearly equivalent}, denoted $D\sim D'$ if $D-D'$ is principal. Taking $\Div X$ modulo the subgroup of principal divisors yields the \emph{divisor class group of $X$}, which is denoted by $\Cl X$.
\end{definition}

The divisor class group is an important geometric invariant that behaves similarly to the ideal class group of number theory. In fact, if $A$ is a Dedekind domain, then $\Cl(\Spec A)$ is exactly the ideal class group of $A$. Now we describe another invariant, closely related to the divisor class group. To do this, we need the definition of an invertible sheaf. Invertible sheaves are sometimes referred to as line bundles, but we will not use this terminology.
\begin{definition}
For a ringed space $X$, an \emph{invertible sheaf} is a locally free $\calO_X$-module of rank one.
\end{definition}
\begin{definition}\label{ampleDef}
For an invertible sheaf $\mathcal{L}$ on a $k$-variety $X$, we say that $\mathcal{L}$ is \emph{ample} if we can find some $n>0$ such that there is an $N>0$ that allows a projective embedding $j:X\to\Proj^N$ and $\mathcal{L}^{\otimes n}=j^*(\calO_X(1))$.
\end{definition}
\noindent This definition says that being ample is equivalent to some tensor power of the sheaf looking like the hyperplane sections of a projective space.
\begin{remark}
The local isomorphism between the ring of regular functions and the Riemann-Roch space in the previous remark tells us that each divisor defines an invertible sheaf.
\end{remark}
\begin{proposition}\label{picDef}
For a ringed space $X$, the set of isomorphism classes of invertible sheaves forms a group, called the \emph{Picard group} under the tensor product (of sheaves). The Picard group of $X$ is denoted $\Pic X$.
\begin{proof}
We check that any two invertible sheaves $\calL,\calM$ on $X$ form another invertible sheaf, i.e. $\calL\otimes_{\calO_X}\calM$ is locally free and rank 1. Being locally free is certainly a local property, so take an affine open set $U$ of $X$. Then from the properties of the tensor product of sheaves, we get
\[
(\calL\otimes_{\calO_X}\calM)|_U=\calL(U)\otimes_{\calO_X(U)}\calM(U).
\]
Then since both $\calL$ and $\calM$ are locally free of rank 1, 
\[
\calL(U)\otimes_{\calO_X(U)}\calM(U)\cong\calO_X(U)\otimes_{\calO_X(U)}\calO_X(U)\cong\calO_X.
\]
This tells us that the set of invertible sheaves on $X$ is closed under the tensor product of sheaves. Second, it is clear that $\calO_X$ acts as an identity element. Lastly, the inverses in $\Pic(X)$ are the duals of invertible sheaves. For any $\calL$ an invertible sheaf, its dual $\check\calL$ is defined to be $\sheafhom_{\calO_X}(\calL,\calO_X)$. Then we apply \cite{hartshorne} Ex. II.5.1b, and obtain
\[
\check\calL\otimes_{\calO_X}\calL\cong\sheafhom_{\calO_X}(\calL,\calL).
\]
The discussion in Remark~\ref{divSpace} demonstrates a correspondence between invertible sheaves and divisors. During that discussion, we saw that multiplying sections of an invertible sheaf by global sections gives an element of the same invertible sheaf, hence
\[
\sheafhom_{\calO_X}(\calL,\calL)\cong\calO_X.
\] 
\end{proof}
\end{proposition}
\begin{remark}
The Picard group of $X$ is naturally isomorphic to $H^1(X,\calO_X^*)$, the first sheaf cohomology group of $X$ with coefficients in $\calO_X^*$. We will not get into the details of sheaf cohomology, but this identification is widely used in classifying surfaces.
\end{remark}
\noindent If $X$ is a variety that is noetherian, integral, and locally factorial, then $\Cl X\cong \Pic X$. We will not prove this here, but it importantly points out that the Picard group generalizes the divisor class group.
\subsection{Galois action on divisors}
In this section we will explain how the divisors on a smooth, projective, geometrically integral $k$-variety $X$ interact with the absolute Galois group of $k$. We will assume that $k$ is a number field, but this is not the most general setting in which these descriptions hold. Denote the absolute Galois group of $k$ by
\[
\GG_k=\Gal(k_s/k),
\]
where $k_s$ denotes the separable closure of $k$, and fix an embedding
\[
X\hookrightarrow \overline{X},
\]
where $\overline{X}$ is the base extension of $X$ to some fixed algebraic closure $\overline{k}$ of $k$. All of the prime divisors of $\overline{X}$ have defining equations, and so for $g\in\GG_k$, we can apply $g$ to all of the coefficients of those defining equations and obtain an action of $\GG_k$ on $\Div\overline{X}$. Certainly, this action will send principal divisors to principal divisors, so we also get an action on $\Pic \overline{X}$.
\section{Surfaces}
\subsection{Intersections on surfaces}
In this section we present results specific to surfaces, rather than the abstract varieties of previous sections.
\begin{definition}
A \emph{surface} is a smooth projective variety of dimension 2. A \emph{curve} on a surface will be any effective divisor on the surface. A \emph{point} is a closed point.
\end{definition}
\begin{definition}
The \emph{canonical sheaf} of a surface $X$ over $k$ is written $\omega_X$ and defined as $\omega_X=\bigwedge^2\Omega_{X/k}$, where $\Omega_{X/k}$ is the sheaf of differentials on $X$ defined over $k$. The canonical sheaf is invertible, and can be thought of as the space of all 2-forms on the surface. (Similarly, $\Omega_{X/k}$ can be thought of as the space of 1-forms.) Any divisor $K$ whose linear equivalence class in $\Pic X$ corresponds to $\omega_X$ is a \emph{canonical divisor}.
\end{definition}
From here we discuss how curves intersect on a surface. If $C$ and $D$ are divisors corresponding to curves on a surface $X$, then $C$ and $D$ intersect \emph{transversally} at some common point $P$ if $C$ and $D$ have local equations $f,g$ at $P$ such that $f,g$ generate the maximal ideal $\mathfrak{m}_p$ of $\calO_{X,p}$. We would like to have a function that counts the points at which two curves meet transversally.
\begin{theorem}
There is a unique map $\Div X\times \Div X\to\ZZ$, denoted by $C.D$ for divisors $C,D$ with the properties:
\begin{enumerate}
\item If $C$ and $D$ are curves meeting transversally, then $C.D=\#(C\cap D)$,
\item $C.D=D.C$,
\item $(C_1+C_2).D=C_1.D+C_2.D$,
\item if $C_1\sim C_2$ then $C_1.D=C_2.D$.
\end{enumerate}
\end{theorem}
\noindent If $C$ and $D$ are curves on $X$ with no common irreducible component and $P\in C\cap D$, then the \emph{intersection multiplicity} at $P$, $(C.D)_P$ is defined as the length of $\calO_{X,P}/(f,g)$ considered as a module over $\calO_{X,P}$, where $f,g$ are local representations of $C,D$.
\begin{proposition}
 If $C$ and $D$ are curves on a surface $X$, then $C.D=\sum_{P\in C\cap D} (C.D)_P$.
\end{proposition}
For a curve $C$ on $X$, we can also talk about $C.C$, or $C^2$, the \emph{self-intersection} number of $C$. We define the self-intersection as \[C^2=\deg_C(\mathscr{N}_{C/X}),\] where $\mathscr{N}_{C/X}$ is the \emph{normal sheaf} of $C$ in $X$. The degree $\deg$ of an invertible sheaf can be defined either in terms of Euler characteristic, or more intuitively in the following way: for an invertible sheaf $\calL$ on $X$, take any nonzero rational section $s\in\calL$ and add up the orders of its zeros and poles. Importantly, this definition allows for curves having \emph{negative} self-intersection. To demonstrate this, we present a standard example.

\begin{example}[Blowing up a plane at a point]
Let $k$ be a field, and consider the projective plane $\Proj^2$ over $k$ along with a point $P\in\Proj^2$. Let $\widetilde{X}$ denote the blow up of $\Proj^2$ at $P$, and 
\[\pi:\widetilde{X}\to\Proj^2\] 
be the projection. Let $E=\pi^{-1}(P)$ be the exceptional curve. We show two ways of investigating the intersection number $E^2$. The first way is not exactly revealing. Since any single point is nonsingular, we may apply \cite{hartshorne} Theorem II.8.24c, which says that the 
\[\mathscr{N}_{E/\widetilde{X}} \cong\calO_{E}(-1).\] The sheaf $\calO_E(-1)$ consists of homogeneous polynomials regular on $E$ with total degree $-1$. By the definition of the self-intersection number above, this tells us that $E^2=1$ as desired.

For a more hands-on interpretation of this intersection, we rely on the fact that $\pi$ is an isomorphism between $\widetilde{X}\setminus E$ and $X\setminus \{P\}$. So, if $\ell_1$ and $\ell_2$ are distinct lines in $\Proj^2\setminus\{P\}$, then $\ell_1.\ell_2=1$, since any two distinct lines in the projective plane intersect in one point. The preimages $\pi^{-1}\ell_1,\pi^{-1}\ell_2$ are the strict transforms of $\ell_1$ and $\ell_2$, which we will denote by $\widetilde{\ell_1},\widetilde{\ell_2}$. Since neither line intersects $P$, their strict transforms are isomorphic to the original lines, so the strict transforms intersect in a single point as well. Now, the blow up construction is designed to preserve intersections of \emph{classes} of lines, so we in fact have that any two representative lines from $\Proj^2$ should intersect in a single point in the blow up $\widetilde{X}$. So now let $\ell_1^\prime,\ell_2^\prime$ be two distinct lines in $\Proj^2$ going through $P$. Since $P$ has been blown up, the inverse images of $\ell_1^\prime, \ell_2^\prime$ look like $\widetilde{\ell_1^\prime}+E,\widetilde{\ell_2^\prime}+E$, respectively, and importantly the strict transforms $\widetilde{\ell_1^\prime},\widetilde{\ell_2^\prime}$ are disjoint in $\widetilde{X}$. The condition that the intersection pairing still must return 1 on these lines leaves the following:
\begin{align*}
1=(\widetilde{\ell_1^\prime}+E).(\widetilde{\ell_2^\prime}+E)&=\widetilde{\ell_1^\prime}.\widetilde{\ell_2^\prime}+\widetilde{\ell_1^\prime}.E+\widetilde{\ell_2^\prime}.E+E^2\\
&=0+1+1+E^2=2+E^2
\end{align*}
Thus, $E^2=-1$. This example importantly demonstrates that divisors of negative self-intersection arise frequently and naturally in algebraic geometry.
\end{example}

We include statements of several standard theorems that are generally useful for performing computations on varieties.
\begin{theorem}[A special case of Serre duality]
For a nonsingular projective variety $X$ of dimension $n$ over a field $k$, then for $p\in\{0,1,\ldots,n\}$ we define $\Omega_{X}^p=\bigwedge^p\Omega_{X/k}$. Then for $p,q\in\{0,1\ldots,n\}$, we have isomorphisms:
\[
H^q(X,\Omega_X^p)\cong H^{n-q}(X,\Omega^{n-p})^*.
\]
\end{theorem}
\noindent The general statement of Serre duality holds for any projective scheme and coherent sheaf on that scheme, but we do not need this version of the theorem.
\begin{proposition}[Adjunction formula for surfaces]
If $C$ is a nonsingular curve of genus $g$ on $X$, and $K$ is the canonical divisor on $X$, then we have
\[2g-2=C.(C+K).\]
\end{proposition}
\noindent This formula describes concretely how curves on a surface interact with the surface's canonical divisor.
The following theorem is a celebrated result of algebraic geometry, it demonstrates a strong connection between the topological and algebraic properties of a variety. To present the theorem, we need some notational conventions: for a divisor $D$ on $X$, we let $\ell(D)=\dim H^0(X,\mathcal{L}(D))$, $s(D)=\dim H^1(X,\mathcal{L}(D))$, and $p_a=\chi(\calO_X)-1$.
\begin{remark}
This $p_a$ is called the \emph{arithmetic genus} of $X$. There is also $p_g$, the \emph{geometric genus} of $X$, which is defined as $p_g(X)=\dim_k H^2(X,\calO_X)$.
\end{remark}
\begin{theorem}[Riemann-Roch for surfaces]
For any divisor $D$ on $X$, we have \[\ell(D)-s(D)+\ell(K-D)=\frac{1}{2}D.(D-K)+1+p_a.\]
\end{theorem}
\noindent The left hand side of the above is actually the Euler characteristic of $D$, which is often written
\[
\chi(D)=\sum_{i=0}^2 (-1)^i\dim H^i(X,\calL(D)).
\]
\subsection{Classification of surfaces}
In this section we describe different classes of surfaces. In this section $X$ will be a projective surface over a field $k$, with $\text{char}(k)\neq2,3$, and we denote the canonical divisor of $X$ by $K$.
\begin{definition}
The \emph{Kodaira dimension} $\kappa(X)$ is defined as the transcendence degree of the so-called \emph{canonical ring}:
\[R=\bigoplus_{n\geq0}H^0(X,\mathcal{L}(nK))\]
minus 1. So $\kappa(X)=\text{trdeg}_k(R)-1$. Both the canonical ring and the Kodaira dimension of $X$ are birational invariants. An alternative definition of $\kappa(X)$ is the largest dimension of the image of $X$ in $\Proj^N$ (for suitable $N$) under the map determined by the linear system $|nK|$ for some $n\geq1$, or $\kappa(X)=-1$ if $|nK|=\emptyset$ for all $n\geq1$.
\end{definition}
Surfaces are classified by their Kodaira dimensions, and fall into several categories. This classification is usually split into several results, which we present now.
\begin{theorem}[Surfaces with $\kappa(X)=-1$]
If $X$ is \emph{rational} or \emph{ruled}, then $\kappa(X)=-1$, which is equivalent to $|12K|=\emptyset$.
\end{theorem}
\begin{theorem}[Surfaces with $\kappa(X)=0$]\label{classification}
We have that \[\kappa(X)=0\iff 12K=0.\] A surface in this class fits into one of four descriptions:
\begin{enumerate}
\item a \emph{K3 surface}, which has $K=0$, and $p_a=p_g=1$,
\item an \emph{Enriques surface}, which has $2K=0$ and $p_a=p_g=0$,
\item an \emph{abelian variety of dimension 2}, which has $p_a=-1,p_g=1$, or
\item a \emph{hyperelliptic surface}, which is a surface $X$ with a morphism $X\to\Proj^1$ such that the preimage of $\Proj^1$ is a family of elliptic curves on $X$.
\end{enumerate}
\end{theorem}
\begin{theorem}[Surfaces with $\kappa(X)=1$]
If $\kappa(X)=1$, then $X$ is an \emph{elliptic surface}, which means that there is a morphism $X\to C$ for some curve $C$ such that almost all fibers of the morphism are nonsingular elliptic curves.
\end{theorem}
\begin{theorem}[Surfaces with $\kappa(X)=2$]
We have $\kappa(X)=2$ if and only if there is some $n>0$ such that the morphism determined by $|nK|$ from $X$ into $\Proj^N$ is birational. Such surfaces are referred to as \emph{surfaces of general type}. 
\end{theorem}
\section{Weighted projective spaces}
Weighted projective spaces are slight generalizations of regular projective space. These spaces give us a way to apply the machinery of projective varieties to varieties that would not normally be projective, i.e. varieties that are defined by non-homogeneous equations.

The first definition of these spaces looks similar to the usual construction of projective space.
\begin{definition}
Let $a=(a_0,\ldots,a_n)\in(\ZZ^+)^{n+1}$. We call this $a$ a \emph{weight vector}, or just a \emph{weight}. Given a field $k^\times$, we can define an action on $\Affine^{n+1}_k\setminus\{0\}$ by
\[
\lambda\cdot(x_0,\ldots,x_n)=(\lambda^{a_0}x_0,\ldots,\lambda^{a_n}x_n),
\]
for $\lambda\in k^\times, (x_0,\ldots,x_n)\in\Affine^{n+1}_k\setminus\{0\}$. We refer to this action on $\Affine^{n+1}\setminus\{0\}$ by $k^\times_a$.
\end{definition}
\begin{definition}
Given a weight vector $a$, the \emph{$a$-weighted projective space} is defined as
\[
\Proj(a)=\Proj(a_0,\ldots,a_n)=(\Affine^{n+1}_k\setminus\{0\})/k^\times_a.
\]
A point $x\in\Proj(a)$ is written
\[
x=[x_0:\cdots:x_n]_a.
\]
\end{definition}
\begin{example}
Setting $a=(1,1,\ldots,1)$ recovers the usual projective space, $\Proj(1,1,\ldots,1)=\Proj^n$.
\end{example}
Given a weight $a$, we the coordinate ring of the corresponding weighted projective space is the $n+1$-variable polynomial ring $k_a[x_0,\ldots,x_n]$, where each $x_i$ has degree $a_i$. This makes the main difference between projective space and weighted projective space clear: we're changing gradings on a polynomial ring. The degree of a monomial in $k_a[x_0,\ldots,x_n]$ is thus given by
\[
\deg\left(\prod_{i=0}^n x_i^{c_i}\right)=\sum_{i=0}^n a_ic_i,
\]
for $c_i\in\ZZ_{\geq0}$. A polynomial $f\in k_a[x_0,\ldots,x_n]$ is called $a$-weighted homogeneous of degree $d$, or just weighted homogeneous of degree $d$, if each monomial in $f$ has degree $d$. 

For $\lambda\in k^\times$, $f\in k_a[x_0,\ldots,x_n]$ a weighted homogeneous polynomial of degree $d$, we have
\[
f(\lambda^{a_0}x_0,\ldots,\lambda^{a_n}x_n)=\lambda^d f(x_0,\ldots,x_n).
\]
Importantly, this tells us that for $p\in\Proj(a)$, 
\[
f(\lambda^{a_0}p_0,\ldots,\lambda^{a_n}p_n)=\lambda^d f(p_0,\ldots,p_n)
\]
if and only if $f(p_0,\ldots,p_n)=0$. This tells us that evaluating these functions at points in weighted projective space is strange, but considering the zero sets of these functions still works well. Since we are defining these spaces in order to consider varieties, i.e. vanishing loci of polynomials, this is all that matters.

More scheme-theoretically, given the polynomial algebra $k_a[x_0,\ldots,x_n]$, we can define the $a$-weighted projective space to be $\text{Proj}(k_a[x_0,\ldots,x_n])$.
\chapter{Arithmetic}
This chapter reviews the motivation and theory behind the search for rational points. Many classical problems in number theory arise from trying to solve equations over $\ZZ$ or $\QQ$. These are referred to as ``Diophantine problems". The most well-known Diophantine problem is Fermat's last theorem.
\begin{theorem}[Fermat's last theorem]
For a positive integer $n>2$, the equation \[x^n+y^n=1\] has no nontrivial solutions $x,y\in\QQ$.
\end{theorem}
\noindent Fermat first wrote down this assertion in 1637, and but it was not proved until 1995 by Andrew Wiles, using techniques from algebraic geometry as well as number theory. We will not be delving into the precise methods used to prove Fermat's last theorem, but the general methods used to attack such a problem are highly relevant to this thesis.
\section{Hensel's lemma and local solubility}
Given a function $F(X_1,\ldots,X_n)\in\ZZ[X_1,\ldots,X_n]$, it is in general extremely difficult to determine if there exists nontrivial $(a_1,\ldots,a_n)\in\ZZ^n$ such that $F(a_1,\ldots,a_n)=0$. It is easier to begin looking at \[F(X_1,\ldots,X_n)\equiv0\bmod p,\] where $p$ denotes a prime number. If such a solution exists, one may look at varying $p$, or by looking mod $p^k$ for some $k>1$. Following the latter path leads naturally to wondering if we can describe solutions $F(X_1,\ldots,X_n)\equiv0\bmod p^k$ for all $k\in\ZZ^+$, and where such solutions would live. Hensel's lemma is the result at the start of this investigation.
\begin{theorem}[Hensel's lemma]
Let $f\in\ZZ[X]$ be a polynomial, and suppose that we have $k,n\in\ZZ$ with $0\leq2k<n$ and $x\in\ZZ$ such that
\begin{align*}
f(x)&=0\bmod p^n,\\
f'(x)&=0\bmod p^k,\\
f'(x)&\neq0\bmod p^{k+1}.
\end{align*}
Then there exists $y\in\ZZ$ such that 
\begin{align*}
y&=x\bmod p^{n-k},\\ f(y)&=0\bmod p^{n+1},\\ 
f'(y)&=0\bmod p^k,\\ f'(y)&\neq0\bmod p^{k+1}.
\end{align*}
\end{theorem}
This theorem lets us take a solution mod $p^k$ and obtain a new solution mod $p^{k+1}$. Iterating gives a sequence of solutions mod $p^n$ for arbitrarily large $n$. Ultimately, we obtain a solution $x_\infty$ that solves the equation mod $p^k$ for all $k$. This solution is not a normal integer, but a so-called \emph{$p$-adic integer}.
\begin{definition}
Given a prime number $p$, the \emph{$p$-adic integers}, denoted $\ZZ_p$ are defined as the projective limit:\[\ZZ_p=\varprojlim_n\ZZ/p^n\ZZ.\] The \emph{$p$-adic field}, denoted $\QQ_p$ is defined as the field of fractions of $\ZZ_p$, \[\QQ_p=\Frac\ZZ_p.\]
\end{definition} 
An alternative and possibly helpful definition/characterization of the $p$-adic integers is as the set of formal power series in $p$ with integer coefficients, $\ZZ[[X]]/(X-p)$. This definition is equivalent to the one given above. 
When determining if an equation has solutions in $\ZZ$ or $\QQ$, beginning the search in $\ZZ_p$ or $\QQ_p$ is common. Any such solutions found are referred to as \emph{local solutions}, while solutions found in $\ZZ$ or $\QQ$ are referred to as \emph{global solutions}. One would hope that being able to find local solutions in $\ZZ_p$ or $\QQ_p$ for all $p$ would imply the existence of a global solution, but sadly this is not true in general. An equation for which this implication does not hold is said to be \emph{locally soluble} but not \emph{globally soluble}. We demonstrate an example of a locally but not globally soluble equation.

\begin{example}
Define $f(X)\in\ZZ[X]$ by \[f(X)=(X^2-13)(X^2-17)(X^2-221).\] It is clear that this equation has no solutions in the integers, since there are no integers that square to 13, 17, or 221. There are, however, $p$-adic solutions for any $p$. Noting that $221=13\cdot 17$ and supposing that $p$ is an \emph{odd} prime different from $13,17$, we have that \[\left(\frac{13}{p}\right)\left(\frac{17}{p}\right)=\left(\frac{221}{p}\right),\] since the Legendre symbol is multiplicative in its top argument. Each term in this expression is either 1 or $-1$. Supposing that neither 13 nor 17 is a square mod $p$, the multiplicativity gives that 221 must be a square mod $p$. So, if $p$ is not 13 or 17, then the equation has solutions mod $p$. If $p=13$, then $17=2^2\bmod13$, so the equation is solvable mod 13, and if $p=17$, then $13=8^2\bmod17$, and so the equation is solvable mod 17. From here we have enough to satisfy the hypotheses of Hensel's lemma, which gives the local solutions at all odd $p$. For $p=2$, we start by noticing that $17=1=5^2\bmod 8$, so that the equation has a solution mod $2^3$. This also works mod 2 and mod 4, which allows us to obtain the conditions necessary to apply Hensel's lemma and obtain a 2-adic solution. So, $f$ has solutions in $\ZZ_p$ for any prime $p$, but no solutions in $\ZZ$.
\end{example}

\section{Rational points on varieties}
Suppose that $X$ is a subvariety of $n$-dimensional affine space $\Affine^n_k$ over some algebraically closed field $k$ and $n\geq1$. Further suppose that $X$ is defined by a set of polynomial equations $f_i(X_1,\ldots,X_n)=0$ for $i=1,\ldots,m,$ with $m\geq1.$  A \emph{$k$-rational point} on $X$ is an $n$-tuple $a=(a_1,\ldots,a_n)\in k^n$ such that \[f_1(a_1,\ldots,a_n)=f_2(a_1,\ldots,a_n)=\cdots=f_m(a_1,\ldots,a_n)=0.\] 
In terms of local data, the above means that the residue field $k(a)$ at the point $a$ is isomorphic to the base field $k$. This is notable, because if $k$ is algebraically closed, then the set of all closed points is exactly the set of $k$-rational points. If $k$ is not algebraically closed, then for a $k$-variety $X$, a closed point $x$ of $X$ could have residue field either isomorphic to $k$ or isomorphic to an extension of $k$. 
Notably, we can describe the set of these points in terms of morphisms in the following way.
\begin{proposition}
Given a variety $X$, the set of $k$-rational points of $X$ is in bijection with the set of morphisms of $k$-schemes $\Spec k\to X$.
\end{proposition}
\begin{proof}
Supposing that $x\in X$ is $k$-rational, we have that $k(x)=\calO_{X,x}/\mathfrak{m}_{X,x}$. The natural surjection $\calO_{X,x}\to k(x)$ induces a map $\Spec k(x)\to\Spec\calO_{X,x}$. This composes with the map $\Spec\calO_{X,x}\to X$ obtained in the following way. Given any affine open neighborhood $U$ of $x$, we have a ring homomorphism $\calO_X(U)\to\calO_{X,x}$ obtained by localization. This induces a map $\Spec\calO_{X,x}\to U$ which composes with the open immersion $U\to X$, yielding $\Spec\calO_{X,x}\to X$ (This does not depend on the choice of $U$). Thus we have a morphism $\Spec k(x)\to X$, and since $k(x)\cong k$, we also get a map $\Spec k\to X$. In terms of sets, this is the unique map sending the point of $\Spec k$ to the point $x$.

Conversely, suppose we have a morphism $\varphi:\Spec k\to X$, and let the image of the point of $\Spec k$ be $x$. Then the local homomorphism $\varphi^\#: k(x)\to k$ is in fact a field homomorphism, and since $k(x)$ is a $k$-algebra, we get $k(x)\cong k$.
\end{proof}

With this, we define the set of $k$-rational points of a variety $X$.

\begin{definition}
Given a variety $X$ over a field $k$, the set of $k$-rational points, or $k$-points, is the set of $k$-scheme morphisms from $\Spec k\to X$, and is denoted $X(k)$.
\end{definition}
\begin{remark}
If we have a field $K$ containing $k$, then we have an embedding \[X(k)\hookrightarrow X(K).\] In general, if we have any morphism $k\to k'$, then the structure morphism of $X$ composes with this map to obtain a map $X\to k'$, giving a map of sets \[X(k)\to X(k').\]
\end{remark}
To connect the idea of rational points on a surface to the idea of local or global solubility, we add must change what we assume about the field of definition $k$. We want our fields of definition to allow the existence of local solutions, and while $\QQ$ is the prototype for this sort of existence, there is a larger class of fields that allows the completions that yielded the $p$-adic fields $\QQ_p$. Indeed, we will now be working with \emph{global fields}, which are finite extensions of $\QQ$ or $\FF_p(t)$. With $\QQ$, one obtains the $p$-adic fields from the valuations obtained from rational primes $p$. With global fields, the valuations that we complete with are referred to as \emph{places}.
\begin{definition}
Let $X$ be a variety defined over a global field $k$. If $X(k_v)\neq\emptyset$ for all places $v$ of $k$ implies that $X(k)\neq\emptyset$, then we say that $X$ satisfies the \emph{Hasse principle}.
\end{definition}
The varieties that we are interested in are those that do not satisfy the Hasse principle. If $X$ is such a variety, then we would like to find some way to explain the failure of $X$ to satisfy the Hasse principle.
\section{The Brauer group}
An historically fruitful way of investigating failures of the Hasse principle is due to Manin, who determined that the \emph{Brauer group} of a variety can contain such information. The Brauer group can be defined in terms of equivalence classes of algebras over the given field, or in terms of Galois cohomology. We will look at both of these interpretations.
\subsection{Brauer groups of fields}
First, we note that for an algebra $A$ over a field $k$, we will denote the \emph{opposite algebra} of $A$ by $A\op$. This $A\op$ is identical to $A$ as a $k$-vector space, but the vector multiplication $\cdot$ is defined as $a\cdot b=ba$, where on the right side the multiplication is that of $A$.
\begin{definition}
Given a field $k$, an \emph{Azumaya algebra} over $k$ is an associative $k$-algebra $A$ satisfying one of the following equivalent conditions:
\begin{enumerate}
\item There is a positive integer $n$ such that $A\otimes_k k_s\cong M_n(k_s)$ as $k$-algebras, where $k_s$ denotes a fixed separable closure of $k$ and $M_n(k_s)$ is the algebra of $n\times n$ matrices with coefficients in $k$.
\item There is a positive integer $r$ such that $A\otimes_k A\op\cong M_r(k)$. Note that this is a matrix algebra over $k$ rather than $k_s$.
\item The algebra $A$ is a finite-dimensional central simple algebra over $k$, which means that it is finite-dimensional as a vector space over $k$, has center equal to $k$, and has no nonzero proper two-sided ideals.
\end{enumerate}
\end{definition}
\noindent This definition highlights that these algebras can be thought of as ``twists" of matrix algebras.
We would like to put some sort of group structure on these algebras, and to do so we need the following proposition, which requires some additional notation. For a field $k$, let $\Az_k$ be the category of Azumaya algebras over $k$. Here, the morphisms are $k$-algebra homomorphisms.

\begin{proposition} For a field $k$, the following hold.
\begin{enumerate} 
\item If $A\in\Az_k$, then $A\op\in\Az_k$.
\item If $A,B\in\Az_k$, then $A\otimes_k B\in\Az_k$.
\item For $A\in\Az_k$ and $L$ a field extension of $k$, then $A\otimes_k L\in\Az_L$.
\end{enumerate}
\end{proposition}
\begin{proof}
Let $A\in\Az_k$, and let $n$ be the integer such that $A\otimes_k k_s\cong M_n(k_s)$. For the first part, we have the following:
\[
A\op\otimes_k k_s\cong(A\otimes_k k_s)\op\cong(M_n(k_s))\op\cong M_n(k_s).
\]
For the second, we refer to \cite{jacobson}, in which this is the contents of Theorem 1 on pg. 114. For the third, we note that certainly $L$ will be simple, as it is a field. So, $A\otimes_k L$ will again be simple, and furthermore will certainly contain $L$ in its center. If the center is larger than $L$, then the center of 
\[
A\otimes_k A\op\otimes_k L\cong M_r(k)\otimes_k L\cong M_r(L),
\]
will also be larger than $L$, but this is not the case.
\end{proof}
\begin{definition}
For a field $k$, let $A$ and $B$ be Azumaya algebras over $k$. We say that $A$ and $B$ are \emph{similar}, denoted $A\sim B$, if there are integers $m,n\geq1$ such that $M_n(A)\cong M_n(B)$.
\end{definition}
\noindent From this, we can define the \emph{Brauer group} $\Br(k)$ of $k$ as $\Az_k/\sim$. The proposition essentially gives us that this forms a group under the tensor product. Multiplication is performed by taking the tensor product of representatives in the classes, and inversion is performed by sending a representative to its opposite algebra. The identity is the class corresponding to $k$.
\begin{remark}\label{covariantBr}
For a field extension $L/k$, and $A\in\Az_k$, the assignment $A\mapsto A\otimes_k L$ in fact defines a group homomorphism $\Br(k)\to \Br(L)$. This says that $\Br$ is a covariant functor from fields to abelian groups.
\end{remark}
The Brauer group of a field has an often useful interpretation as a Galois cohomology group.
\begin{theorem}
Given a field $k$, there is an isomorphism 
\[
\Br(k)\cong H^2(\Gal(k_s/k),k_s^\times).
\]
\end{theorem}
\begin{proof}
The details of this are beyond the scope of this thesis, but they can be found in \cite{serreLF}, X.5.
\end{proof}
\begin{remark} 
The group $H^2(\Gal(k_s/k),k_s^\times)$ is often written as $H^2(k,\mathbb{G}_m)$.
\end{remark}
\begin{example}
Consider $k=\RR$. Then $\RR_s=\CC$, and $\Gal(\CC/\RR)=\ZZ/2\ZZ$. Using the cohomological interpretation of $\Br(\RR)$, we get
\[
\Br(\RR)\cong H^2(\Gal(\CC/\RR),\CC^\times).
\]
Now, in \cite{serreLF} VIII.4, they describe an isomorphism from Tate cohomology $H^2(G,A)\cong A^G/NA$ for any other group $G$ and $G$-module $A$, where $A^G$ denotes the $G$-invariant part of $A$, and $N=\sum_{t\in G}t.$ The interpretation of this $N$ in our setting is as the standard \emph{norm} on $\CC$. We thus have
\[
H^2(\Gal(\CC/\RR),\CC^\times)\cong (\CC^\times)^{\Gal(\CC/\RR)}/N\CC.
\]
The nonidentity element of $\Gal(\CC/\RR)$ is complex conjugation, and so $(\CC^\times)^{\Gal(\CC/\RR)}=\RR$. Furthermore, we have $N\CC=\RR_{\geq0}$. Thus,
\[
(\CC^\times)^{\Gal(\CC/\RR)}/N\CC\cong\RR/\RR_{\geq0}\cong\ZZ/2\ZZ.
\]
So $\Br(\RR)=\ZZ/2\ZZ$. Furthermore, the nontrivial element of $\Br(\RR)$ is the algebra of Hamiltonian quaternions, denoted $\mathbb{H}$. This is the $\RR$ algebra with generators $i,j$ subject to the relations $i^2=j^2=-1, ij=-ji$. This algebra is 4-dimensional over $\RR$, and we have an explicit isomorphism to $2\times2$ matrices over $\CC$ given by
\begin{align*}
\mathbb{H}\otimes_\RR\CC&\longrightarrow\text{M}_2(\CC)\\
1\otimes 1&\longmapsto\begin{pmatrix}1&0\\0&1\end{pmatrix}\\
i\otimes 1&\longmapsto\begin{pmatrix}i&0\\0&-i\end{pmatrix}\\
j\otimes 1&\longmapsto\begin{pmatrix}0&-1\\1&0\end{pmatrix}\\
ij\otimes 1&\longmapsto\begin{pmatrix}0&-i\\-i&0\end{pmatrix}.
\end{align*}
This is the only nontrivial class in $\Br(\RR)$, which is exactly the statement of a result attributed to Frobenius. For this result, we readers to section 2.7 of the introduction of \cite{bahturin}.
\end{example}
\noindent This example motivates the definition of a \emph{quaternion algebra}.
\begin{definition}
Let $k$ be a field of characteristic different from 2 and $a,b\in k^\times$. The \emph{quaternion algebra} associated to $a$ and $b$ is denoted $(a,b)_k$, and is the 4-dimensional $k$-algebra generated by $\{1,i,j,ij\}$ subject to the relations $i^2=a, j^2=b, ij=-ji$.
\end{definition}
\noindent These generalized quaternion algebras are special cases of \emph{cyclic algebras}, whose construction we now present.

Suppose that $k$ is a field and $L$ is a degree $n$ cyclic field extension of $k$. Then for $a\in k^\times$ and $\sigma\in\Gal(L/k)$ a generator, we can obtain a $k$-algebra in the following way. First, define the ``twisted" polynomial ring $L[x]_\sigma$ to be identical as an additive group to $L[x]$, but with multiplication given by
\[
\ell x=\sigma(\ell)x,\quad\forall\ell\in L.
\]
Then, take 
\[
A:=L[x]_\sigma/\langle x^n-a\rangle.
\]
This $A$ is called a \emph{cyclic algebra} over $k$, and is often denoted $(L/k,a)$. These cyclic algebras provide a way to determine explicit elements of the Brauer group, as we will see in the next subsection.

\subsection{Brauer groups of varieties}
Given a variety $X$ defined over a field $k$, defining an object like the Brauer group takes additional work. We have to alter our definitions in order for the Azumaya algebras to be defined over general schemes, rather than just fields.
\begin{definition}
Given a scheme $X$, an \emph{Azumaya algebra} on $X$ is a sheaf $\calA$ of $\calO_X$ algebras that is a coherent, locally free $\calO_X$-module, has $\calA_x\neq0$ for all points $x\in X$, and such that $\calA\otimes_{\calO_X} k(x)$ is an Azumaya algebra over $k(x)$, the residue field at $x$. Given two Azumaya algebras $\mathcal{A},\mathcal{B}$ on $X$, we say that $\mathcal{A}$ and $\mathcal{B}$ are \emph{similar} if there exist locally free, coherent $\calO_X$-modules $\mathcal{E},\mathcal{F}$ such that 
\[
\mathcal{A}\otimes_{\calO_X}\text{End}_{\calO_X}(\mathcal{E})\cong B\otimes_{\calO_X}\text{End}_{\calO_X}(\mathcal{F}).
\]
\end{definition}
\noindent From this we can form the \emph{Azumaya-Brauer group} $\Br_\text{Az}(X)$ of $X$, as the similarity classes of Azumaya algebras over $X$ with operation given by the tensor product of sheaves. Most often, the \emph{Brauer group} of a $k$-scheme $X$ is defined as \[\Br(X)=H^2_\text{\'et}(X,\mathbb{G}_m).\] This is the second \'etale cohomology group of $X$ with coefficients in $\mathbb{G}_m$, the group of nonzero elements of $k_s$. In the case that $X$ is a regular, quasi-projective variety, we have \[\Br_\text{Az}(X)\cong \Br(X).\] We will be working with such varieties, hence will be concerned mostly with the Azumaya-Brauer model rather than the cohomological one.
\begin{remark}
Comparing with Remark~\ref{covariantBr}, forming Brauer groups of varieties is a \emph{contravariant} functor from the category of $k$-schemes to abelian groups.
\end{remark}
As mentioned in the previous subsection, one way to identify elements in the Brauer group is through cyclic algebras.
\begin{proposition}
Consider a field $k$, a cyclic extension $L$ of $k$, and take $X$ to be a smooth, projective, geometrically integral $k$-variety. Given an element $f\in k(X)^\times$, the class of the cyclic algebra $(L/k,f)\in\Br(k(X))$ sits in the image of $\Br(X)\hookrightarrow\Br(k(X))$ if and only if
\[
\div(f)=N_{L/K}(D):=\sum_{\sigma\in\Gal(L/k)}\sigma(D),\quad\text{ for some $D\in\Div(X_L)$.}
\] 
Furthermore, if $\Pic(X_L)=(\Pic(\overline{X}))^{\Gal(L/k)}$, then $(L/k,f)$ comes from $\Br(k)$ if and only if the $D$ in the above display is principal.
\end{proposition}
\begin{proof}
The proof of this relies heavily on cohomological machinery that is beyond the scope of this thesis, and so we refer readers to \cite{corn}, Proposition 2.2.3. 
\end{proof}
\section{The Brauer-Manin obstruction to the Hasse principle}
We saw at the beginning of this chapter an example of a variety that does not satisfy the Hasse principle. The Hasse principle relates the sets $X(k)$ and the set of local points of $X$. Our goal in this section is to define a set of points that sits between these two, and we hope that it can be used to identify objects that prevent the Hasse principle from holding.
Throughout this section, we let $k$ be a global field, $\Omega_k$ be the set of places of $k$, and denote the ring of integers of $k$ by $\calO_k$. When talking about places of $k$, we will let $v$ denote an arbitrary place, and will use $p$ to refer to the finite places. We define the \emph{adeles} of $k$ as the ring
\[
\adele_k=\{(x_v):x_v\in k_v,\text{ and } x_p\in\calO_{k,p}\text{ for all but finitely many $p$.}\}
\]
The adeles of $k$ are also sometimes defined as the ``restricted product"
\[
\adele_k=\sideset{}{^\prime}\prod_v k_v,
\]
where the prime symbol denotes as in the first definition that all but finitely many entries in any of the elements are $v$-adic integers. This construction is a slight generalization of 
\[
\hat{\ZZ}=\prod_{p\text{ a prime}}\ZZ_p,
\] 
since we allow some coordinates of elements of $\adele_k$ to sit outside of the integer rings. We refer to points of $X(\adele_k)$ as \emph{ad\'elic} points.

With the definition of adeles and the Brauer group, we present the workhorse of this section, the so-called \emph{fundamental sequence of global class field theory}.
\begin{theorem} For a global field $k$, the sequence of groups
\[
0\longrightarrow \Br(k)\longrightarrow \bigoplus_{v\in\Omega}\Br(k_v)\longrightarrow \QQ/\ZZ\longrightarrow0
\]
is exact.\label{sequence}
\end{theorem}
\noindent In the above exact sequence, the second arrow is the diagonal embedding obtained from sending $\calA\in\Br(k)$ to the sequence $(\calA\otimes_k k_v)\in\bigoplus_{v\in\Omega}\Br(k_v)$, and the third arrow is obtained from the sum of the local invariant maps, denoted $\sum_{v\in\Omega} \inv_v$.   Each of these maps $\inv_v:\Br(k_v)\hookrightarrow\QQ/\ZZ$ comes from class field theory, and is sometimes called the local Artin map, or local invariant map. We will not include the details of the construction of this map here, but refer the reader to \cite{milneCFT}. Importantly, each of the sums of invariant maps is finite. The reason for this is essentially because $\Br(\calO_{k_v})=0$, where $\calO_{k_v}$ denotes the integer ring of $k_v$. Since for an ad\'elic point $(x_v)$ we have that all but finitely many coordinates lie in $\calO_{k,v}$, we get the desired finiteness. For more details about this finiteness, see \cite{skoQpoints} Section 5.5.2.

To see how varieties interact with this sequence, suppose that $X$ is a smooth, projective, geometrically integral variety over $k$. For any field extension $K/k$ and each $\calA\in\Br(X)$, we define the \emph{specialization} or \emph{evaluation} map
\begin{align*}
\ev_\calA:X(K)&\longrightarrow\Br(K)\\
x&\longmapsto\calA_x\otimes_{\calO_{X,x}}K.
\end{align*}
We can consider all of these maps at once, as $\calA$ ranges over $\Br(X)$, and obtain a pairing
\begin{align*}
\phi:\Br(X)\times X(\adele_k)&\longrightarrow\QQ/\ZZ\\
(\calA,(x_v))&\longmapsto\sum_{v\in\Omega}\inv_v(\ev_\calA(x_v)).
\end{align*}
Along with the embedding $k\hookrightarrow\adele_k$, the above maps and the fundamental sequence give us a commutative diagram for each $\calA\in\Br(X)$:
\begin{figure}[h]
\centering
\begin{tikzcd}
{}&X(k)\ar{r}\ar{d}{\ev_\calA}&X(\adele_k)\ar{d}{\ev_\calA}\ar{dr}{\phi(\calA,-)}\\
0\ar{r}&\Br(k)\ar{r}&\bigoplus_{v\in\Omega}\Br(k_v)\ar{r}&\QQ/\ZZ\ar{r}&0.
\end{tikzcd}
\end{figure}
\begin{definition}
Let $X$ be a smooth, projective, geometrically integral variety over a global field $k$. Then for $\calA\in\Br(X)$, define 
\[
X(\adele_k)^\calA=\{(x_v)\in X(\adele_k):\phi(\calA,(x_v))=0\}.
\]
From this, we define the \emph{Brauer-Manin set} as
\[
X(\adele_k)^{\Br}=\bigcap_{\calA\in\Br(X)}X(\adele_k)^\calA.
\]
We say that $X$ \emph{has a Brauer-Manin obstruction to the Hasse principle} if $X(\adele_k)\neq\emptyset$ but $X(\adele_k)^{\Br}=\emptyset$.
\end{definition}
\noindent The commutativity of the previous diagram provides the justification of the inclusions
\[
X(k)\subseteq X(\adele_k)^{\Br}\subseteq X(\adele_k)
\]
as mentioned at the beginning of this section.

Now that we've identified this intermediate set, we'd like to be able to compute it in some way. Supposing that $X$ is a smooth, projective, geometrically integral variety over a global field $k$ with $X(\adele_k)\neq\emptyset,$ what we want to determine is whether or not there are any ad\'elic points $(x_v)$ such that for any $\calA\in\Br(X)$, $\phi(\calA,(x_v))=0$. The difficulty of this question lies not in the structure of $X(\adele_k)$, but rather in finding elements $\calA\in\Br(X)$ that specialize to 0 at a given ad\'elic point. To narrow down which parts of the Brauer group to search for such algebras, we note the following.
\begin{proposition}
Let $X$ be a smooth, projective, geometrically integral variety over a global field $k$, and suppose that $X$ has local solutions, i.e. $\prod_v X(k_v)\neq\emptyset$. Then the natural map $\Br(k)\to\Br(X)$ is injective.
\end{proposition}
\begin{proof}
By Theorem~\ref{sequence}, we know that we have an injection $\Br(k)\hookrightarrow\bigoplus_{v\in\Omega}\Br(k_v)$. Furthermore, functoriality of $\Br$ gives a map $\Br(k)\to\Br(X)$, and the aforementioned injection factors as
\[ 
\begin{tikzcd}
\Br(k)\ar{r}&\Br(X)\ar{r}{\phi(\calA,-)}&\bigoplus_{v\in\Omega}\Br(k_v).
\end{tikzcd}
\]
Now, since we know that the composition of these two is injective, we obtain that the first map is an injection.
\end{proof}
\noindent Keeping $X$ as in the proposition, the image of $\Br(k)$ in $\Br(X)$ is referred to as the set of \emph{constant} algebras, and is denoted by $\Br_0(X)$. For any such algebra, Theorem~\ref{sequence} tells us that the sum of the local invariants vanishes, which says that any algebra coming from $\Br(k)$ will not obstruct the Hasse principle. These constant algebras are a subset of another piece of the Brauer group comes from elements $\calA\in\Br(X)$ that split over $\overline{X}$, that is, those algebras that upon base extension to $\overline{k}$ become isomorphic to a matrix algebra over $\overline{k}$. This piece of the group is sometimes called the \emph{algebraic} Brauer group, denoted $\Br_1(X)$, and with respect to the specialization map of interest, it is more mysterious than $\Br_0(X)$. Thus, the quotient \[\frac{\Br_1(X)}{\Br_0(X)}\] provides a reasonable place to look for possible obstructing algebras. To compute this, we use the following isomorphism.
\begin{proposition}
\[
\frac{\Br_1(X)}{\Br_0(X)}\cong H^1(\Gal(k_s/k),\Pic(\overline{X})).
\]
\end{proposition}
\begin{proof}
This is Proposition 1.3.7 in \cite{corn}.
\end{proof}
\noindent This proposition is incredibly useful, since it is relatively easier to compute the object on the right side in the above display. But, computing $\Pic(\overline{X})$ still requires a significant amount of work, and is rarely done explicitly. We will be computing $\Pic(\overline{X})$ for a specific $X$ by trying to find as many linearly independent divisor classes as we can.
\section{An example of a Brauer-Manin obstruction}
In this section we work through an example due to Iskovkikh of a surface with a Brauer-Manin obstruction, following \cite{qPoints}, section  8.2. Set $B:=\Proj^1_\QQ$, the projective line over $\QQ$ with coordinates $w,x$, and consider the rank 3 bundle over $B$ defined by
\[
\mathscr{E}=\calO_B\oplus\calO_B\oplus\calO_B(2).
\]
We can form the scheme 
\[
\text{Proj}(\text{Sym}\mathscr{E})
\]
from this, and define $X$ to be the zero locus in $\text{Proj}(\text{Sym}\mathscr{E})$ of
\[
s=s_0+s_1+s_2,
\]
where 
\[
s_0=1, s_1=1, s_2=(w^2-3x^2)(x^2-2w^2).
\]
Such an $s$ is called a \emph{diagonal conic bundle}. This $X$ is a \emph{Ch\^atelet} surface, which by definition is the vanishing locus of a diagonal conic bundle with $s_0=1, s_1=-a$ for $a\in\QQ^\times$, and $s_2=-F(w,x)$ for $F$ a separable, homogeneous polynomial of degree 4 in homogeneous coordinates $w,x$. Any such surface has a map to $B$ whose fibers are conics and contains as an open subscheme a smooth, affine, geometrically integral surface of the form
\[
y^2-az^2=F(1,x).
\] 
The surface $X$ contains the smooth affine surface with defining equation
\[
y^2+z^2=(3-x^2)(x^2-2).
\]
Furthermore, this $X$ is integral, so we may speak about its function field $k(X)$. Define $A$ to be the quaternion algebra $A=(3-x^2,-1)$ over $k(X)$, and identify $A$ with its class in $\Br(k(X))$. As with all quaternion algebras, this $A$ has order 2 in the Brauer group, i.e. $A+A=0$. Our goal will be to show that the evaluation map is nonzero for this $A$ as an element of $\Br(X)$. But as it is defined, $A$ is an element of $\Br(k(X))$, not $\Br(X)$. We can think of $\Br(X)$ as a subgroup of $\Br(k(X))$, but it takes more work to see $A$ as an element of $\Br(X)$. To this end, we need the following theorem about residue homomorphisms and a proposition about splitting cyclic algebras, both which we present without proof.
\begin{theorem}
Given a regular, integral, Noetherian scheme $X$, the sequence
\[
0\to\Br(X)\to\Br(k(X))\xrightarrow{\text{res}}\bigoplus_{\substack{x\in X\text{ a point of}\\\text{codimension 1}}}H^1(k(x),\QQ/\ZZ)
\]
is exact, where res denotes the residue homomorphism. If $X$ is of dimension $\leq1$ and one of the $k(x)$ is imperfect of characteristic $p$, or if $X$ has dimension $\geq2$ and one of the $k(x)$ has characteristic $p$, we must exclude the $p$-primary parts from all of the above groups.
\end{theorem}
\begin{proposition}\label{splitting}
For $L$ a cyclic extension of a field $k$, and $\chi$ a generator of $\Gal(L/k)$, then for $a\in k^\times$, the $k$-algebra $(a,\chi)$ is split if and only if $a\in N_{L/k}(L^\times)$.
\end{proposition}
\noindent With these in hand, we tackle the following proposition.
\begin{proposition}
The class $A\in\Br(k(X))$ lies in the subgroup $\Br(X)$.
\end{proposition}
\begin{proof}
Considering the above theorem, it will be sufficient to show that $A$ is in the kernel of the residue homomorphism, and to do this we must find an open covering $\{U_i\}$ of $X$ such that some elements of each $\Br(U_i)$ to which $A$ extends. In order to do this we will need to find other ways to express $A$. Define 
\[
B=(x^2-2,-1),\hspace{0.25cm} C=\left(\frac{3}{x^2}-1,-1\right)
\]
as elements of $\Br(k(X))$. Each of $A,B,C$ is a quaternion algebra over $k(X)$, so has order 2 in $\Br(k(X))$. Using the defining equations of the smooth affine surface contained in $X$, we have
\[
A+B=((3-x^2)(x^2-2),-1)=(y^2+z^2,-1).
\]
Now note that
\[
(y+z\sqrt{-1})(y-z\sqrt{-1})=y^2+z^2.
\]
This says that $y^2+z^2=N_{k(X)(\sqrt{-1})/k(X)}(y+z\sqrt{-1})$, hence by Proposition~\ref{splitting}, $A+B$ is split as a $k(X)$-algebra, which means that it is 0 in the Brauer group. Similarly,
\[
A-C=((3-x^2)(3/x^2-1)^{-1},-1)=(x^2,-1),
\]
and since $x^2$ is a square, we conclude as before that $A-C=0\in\Br(k(X)).$ In summary, we have
\[
A+B=0,\hspace{0.25cm} A-C=0,\hspace{0.25cm} A+A=0,\hspace{0.25cm} B+B=0,\hspace{0.25cm} C+C=0.
\]
Together, these combine to give $A=B=C$. 

Now let $P_{3-x^2}$ be the closed point of $B$ given by $3-x^2=0$, and let $P_{x^2-2}$ be the closed point of $B$ given by $x^2-2=0$. The algebra $A$ represents an Azumaya algebra on all of $A$ except where $3-x^2$ or $-1$ is a zero or a pole. Considering the following open sets:
\begin{align*}
U_A:&=X-(\text{fiber above $\infty$})-(\text{fiber above $P_{3-x^2}$})\\
U_B:&=X-(\text{fiber above $\infty$})-(\text{fiber above $P_{x^2-2}$})\\
U_C:&=X-(\text{fiber above $0$})-(\text{fiber above $P_{3-x^2}$}),
\end{align*}
we can think of $A$ as ``coming from" an element of $\Br(U_A)$, similarly $B$ comes from $\Br(U_B)$, and similarly $C$ comes from $\Br(U_C)$. Since we certainly have \[X=U_A\cup U_B\cup U_C,\] and $A=B=C$ defined on each of these, we obtain that $A$ can be viewed as an element of $\Br(X)$.
\end{proof}
\noindent We can now identify $A$ with its representative in $\Br(X)$. We take the fact that $X(\QQ)=\emptyset$ for granted, which Iskovkikh originally proved using ad hoc methods based on quadratic reciprocity.
\begin{proposition}
We have $X(\adele_\QQ)\neq\emptyset$, but $X(\adele_\QQ)^A=\emptyset$, so there is a Brauer-Manin obstruction to the Hasse principle for $X$.
\end{proposition}
\begin{proof}
In order to check $X(\adele_\QQ)\neq\emptyset$, we used Magma to verify the local solubility at the primes of bad reduction for $X$, which are 2,3, and 7. This is enough to conclude that $X$ has an ad\'elic point.

Now consider $P\in X(\QQ_p)$ for $p$ a finite prime or $\infty$, and pick a representation of $A$ such that $P$ is not a zero or pole of the function of $x$. That is, we know that $A=(3-x^2,-1)=(x^2-2,-1)=(\frac{3}{x^2}-1,-1)$, so given $P$ we pick the representation that avoids degeneracy. Then calling $x=x(P)\in\QQ_p\cup\{\infty\}$, we must consider 3 cases: when $p$ is not 2 or $\infty$, when $p=\infty$, and when $p=2$.

First suppose that $p$ is not 2 or $\infty$, and let $v_p$ denote the $p$-adic valuation. If $v_p(x)<0$, then $v_p(3/x^2)>0$, so $3/x^2-1$ is not divisible by $p$, hence $3/x^2-1\in\ZZ_p^\times$. If $v_p(x)\geq0$, then since $(3-x^2)+(x^2-2)=1$, one of $3-x^2,x^2-2$ is in $\ZZ_p^\times$. In either of these cases, we have that $A(P)=(u_1,u_2)$ for $u_1,u_2\in\ZZ_p^\times$. Hence, $\ev_A(P)\in\Br(\ZZ_p)$. We mentioned in the discussion following Theorem~\ref{sequence} that $\Br(\ZZ_p)=0$, and this lets us conclude that $\inv_p(\ev_A(P))=0$.

Now supposing that $p=\infty$, we consider $f(x)=(3-x^2)(x^2-2)$. Every $P\in X(\RR)$ satisfies $2\leq x(P)^2\leq 3$. This means that either $3-x(P)^2$ or $x(P)^2-2$ is positive, so is in $N_{\CC/\RR}(\CC^\times)=\RR_{>0}$, hence the algebra $\ev_A(P)=0$ by Proposition~\ref{splitting}. So in this case we again have $\inv_p(\ev_A(P))=0$.

Lastly, if $p=2$, take $P\in X(\QQ_2)$ and $x=x(P)$. Then if $v_2(x)>0$, we have
\[
3-x^2\equiv3\equiv-1\equiv4.
\]
If $v_2(x)=0$, then
\[
x^2-2\equiv1-2\equiv-1\bmod4,
\]
and if $v_2(x)<0$, then
\[
\frac{3}{x^2}-1\equiv-1\bmod4.
\]
If a 2-adic integer is $-1\bmod4$, then it can't come from $ N=N_{\QQ_2(\sqrt{-1})/\QQ_2}(\QQ_2(\sqrt{-1}))$, since elements of this $N$ are sums of squares of 2-adic rational numbers, and sums of squares mod 4 are either 0 or 2. In this case, we have that $\inv_2(\ev_A(P))=\frac{1}{2}$. Thus, the invariant map does not vanish on 2-adic points, and we conclude $X(\adele_\QQ)^A=\emptyset$.
\end{proof}
\section{Insufficiency of the Brauer-Manin obstruction}
Unfortunately, it is not true that if a smooth, projective, geometrically integral $k$-variety $X$ has an obstruction to the Hasse principle, then the obstruction is completely described by the Brauer-Manin set $X(\adele_k)^{\Br}$. That is, we may have $X(\adele_k)^{\Br}\neq\emptyset$ but still $X(k)=0$. The first example of such an $X$ is due to Skorobogatov, in \cite{skoEx}. Skorobogatov's example was a bielliptic surface over $\QQ$, and explicitly was birational to the affine surface defined by the equations
\[
(x^2+1)y^2=(x^2+2)z^2=3(t^4-54t^2-117t-243).
\]

Because of the Brauer-Manin obstruction's insufficiency, there has been a search in recent years to find an obstruction set smaller than $X(\adele_k)^{\Br}$ that captures all possible explanations for the failure of the Hasse principle. The current best known improvement to the Brauer-Manin set is the \'etale Brauer-Manin set, which is defined as
\[
X(\adele_k)^{\text{\'et},\Br}=\bigcap_{\substack{G \text{ finite \'etale,}\\ f:Z\to X\text{ a $G$-torsor}}}\bigcup_{\tau\in H^1(k,G)} f^\tau(Z^\tau(\adele_k)^{\Br}),
\]
but even this set does not sufficiently explain all obstructions to the Hasse principle. The first example to show this appears in \cite{poonenEtBrEx}, and is like in the previous section, a Ch\^atelet surface. 
\chapter{K3 Surfaces}
We now turn our attention to our main objects of interest, K3 surfaces. In Theorem~\ref{classification}, we saw K3 surfaces as surfaces of Kodaira dimension 0 and trivial canonical sheaf. Our main concerns will be with \emph{algebraic} K3 surfaces.
\begin{definition}
Given a field $k$, a \emph{K3 surface} $X$ is a 2-dimensional, complete, nonsingular variety over $k$ with \[\omega_X\cong\calO_X,\quad H^1(X,\calO_X)=0.\]
\end{definition}
\noindent There are some comments to be made here. First, the condition $H^1(X,\calO_X)=0$ is the same as saying that the difference between the arithmetic genus and geometric genus is 0. The difference between arithmetic and geometric genera of a variety is sometimes referred to as the \emph{irregularity}. Second, the specification of completeness reflects the properties of K3s as objects with inherent analytic structure. For every K3 defined as above, there is a corresponding compact complex surface with much of the same structure. Specifically, there is an analytic definition of a K3 surface that imposes the same conditions on the canonical sheaf and first cohomology group, but the sheaf is of holomorphic differential forms, rather than of K\"ahler differentials, and the cohomology is de Rham cohomology, rather than sheaf cohomology. It is certainly surprising how few changes need to be made in switching between the algebraic and analytic settings, and there are deep results explaining this correspondence. We will not be studying K3 surfaces from the analytic perspective, but we will be using results from this perspective. We refer the reader to \cite{huybrechts} or \cite{vanDeVen} for a thorough treatment of the analytic aspects of K3s.
\section{Lattices in general}
\begin{definition}
A \emph{lattice} $\Lambda$ is a free $\ZZ$-module of finite rank with a symmetric, nondegenerate, bilinear form
\[
(-.-):\Lambda\times\Lambda\to\ZZ.
\]
A lattice is \emph{even} if for all $x\in\Lambda$, $(x)^2=(x.x)\in2\ZZ$. Otherwise, we say that $\Lambda$ is \emph{odd}. 
\end{definition}
\noindent Since any lattice $\Lambda$ is a free module of finite rank, we have a basis, say $\{x_1,\ldots,x_m\}$, and can form the intersection matrix $(x_i.x_j)_{i,j=1}^n$. This matrix is most commonly called the \emph{Gram} matrix. The determinant of this intersection matrix is called the \emph{discriminant} of $\Lambda$, denoted $\disc(\Lambda)$. Furthermore, from any $\Lambda$ we can extend the intersection form $(-.-)$ to $\RR$ and obtain the real vector space
\[
\Lambda_\RR=\Lambda\otimes_\ZZ\RR.
\]
This extended form can be diagonalized with only $\pm1$ along the diagonal. The existence of such a diagonalization follows from some of the basic properties of quadratic forms over the reals. Because the Gram matrix is symmetric, it is a quadratic form. These forms are amenable to scaling by squares of real numbers. Thus, any scaling transform will preserve sign, so we scale the diagonal elements to have size 1 for convenience. The \emph{signature} of a lattice $\Lambda$ is $(n_+,n_-)$, where $n_+$ is the number of $1$s on the diagonal of the diagonalized Gram matrix of $\Lambda_\RR$, and $n_-$ is the number of $-1$s on the diagonal of the diagonalized Gram matrix of $\Lambda_\RR$. The \emph{index} $\tau(\Lambda)$ of $\Lambda$ is defined as \[\tau(\Lambda)=n_+-n_-.\] We say that $\Lambda$ is \emph{definite} if $n_+=0$ or $n_-=0$, or if $\tau(\Lambda)=\text{rank}(\Lambda)$. Otherwise, $\Lambda$ is \emph{indefinite}.

For any $\Lambda$, we can define an injection into the dual lattice $\Lambda^*=\Hom_\ZZ(\Lambda,\ZZ)$
\begin{align*}
\iota_\Lambda:\Lambda&\to\Lambda^*\\
x&\mapsto(x.-).
\end{align*}
We can consider $\Lambda^*$ as a subset of the elements $x\in\Lambda\otimes_\ZZ\QQ$ such that $(\Lambda.x)\subset\ZZ$, in which case $\iota_\Lambda$ becomes the inclusion \[\Lambda\hookrightarrow\Lambda^*\hookrightarrow\Lambda_\QQ.\] The cokernel of $\iota_\Lambda$ is $\Lambda^*/\Lambda$, and this quotient is called the \emph{discriminant group} of $\Lambda$, often denoted by $A_\Lambda$. This group is finite of order given by the size of the discriminant of $\Lambda$. A lattice $\Lambda$ is \emph{unimodular} if $\iota_\Lambda$ defines an isomorphism, or equivalently if $A_\Lambda$ is trivial, or if the discriminant of $\Lambda$ is $\pm1$.
\begin{example}
The lattice with Gram matrix given by
\[
U=\begin{pmatrix}
0 & 1\\
1 & 0
\end{pmatrix}
\] is often called the \emph{hyperbolic plane}. This is lattice has rank two, and so the Gram matrix tells us
\[
U\cong\ZZ^2\cong\ZZ\cdot x_1\oplus\ZZ\cdot x_2,
\]
where $x_1, x_2$ are generators with $(x_1)^2=(x_2)^2=0, (x_1.x_2)=1$.
\end{example}
\begin{example}
An important lattice is the \emph{root lattice}, $E_8$. This is the unique lattice of rank 8 that is positive definite ($n_-=0$), even, and unimodular. This is most commonly given by the intersection matrix:
\[
E_8=
\begin{pmatrix}
2 & -1 & 0 & 0 & 0 & 0 & 0 & 0\\
-1 & 2 & -1 & 0 & 0 & 0 & 0 & 0\\
0 & -1 & 2 & -1 & -1 & 0 & 0 & 0\\
0 & 0 & -1 & 2 & 0 & 0 & 0 & 0\\
0 & 0 & -1 & 0 & 2 & -1 & 0 & 0\\
0 & 0 & 0 & 0 & -1 & 2 & -1 & 0\\
0 & 0 & 0 & 0 & 0 & -1 & 2 & -1\\
0 & 0 & 0 & 0 & 0 & 0 & -1 & 2
\end{pmatrix}.
\]
\end{example}
\begin{example}
For any lattice $\Lambda$ and $m\in\ZZ$, we can ``twist" $\Lambda$ by $m$ to obtain a new lattice, $\Lambda(m)$. We do this by defining the intersection form on $\Lambda(m)$ to be:
\[
(-.-)_{\Lambda(m)}=m\cdot(-.-)_\Lambda.
\]
As a consequence of this, we get $\disc(\Lambda(m))=\disc(\Lambda)\cdot m^{\text{rk}\Lambda}$.
\end{example}
\section{Lattice structure of K3 surfaces}
In Proposition~\ref{picDef}, we saw one algebraic invariant coming from the divisor structure of a variety. There are others, which we discuss now.
\begin{definition}
For a surface $X$ defined over a field $k$, the \emph{N\'eron-Severi group} of $X$ is denoted $\NS(X)$, and defined as \[\NS(X)=\Pic(X)/\Pic^0(X),\] where $\Pic^0(X)$ is the subgroup of $\Pic(X)$ consisting of those divisor classes linearly equivalent to 0.
\end{definition}
\noindent Another invariant group involves a new kind of equivalence of divisors called \emph{numerical equivalence}. For a class $D\in\Pic(X)$, $D$ is \emph{numerically trivial} if for all $D'\in\Pic(X)$ we have $(D.D')=0$. The set of numerically trivial divisor classes is denoted $\Pic^\tau(X)$. We note that this group contains $\Pic^0(X)$ as a subgroup.
\begin{definition}
For a variety $X$ over a field $k$, we define \[\Num(X)=\Pic(X)/\Pic^\tau(X).\]
\end{definition}
\noindent The group $\Num(X)$ admits a nondegenerate, symmetric pairing
\[
(-,-):\Num(X)\times\Num(X)\to\ZZ.
\]
As with the Picard group, both $\NS(X)$ and $\Num(X)$ are free abelian groups, but more importantly we have the following result.
\begin{theorem}[N\'eron, Severi] For a surface $X$ defined over a field $k$, the groups $\NS(X),\Num(X)$ are finitely generated as abelian groups.
\end{theorem}
\begin{proof}
For this proof, we refer to Theorem 3.25 of \cite{milneET}.
\end{proof}
\noindent This theorem gives us that $\NS(X)$ is in fact a \emph{lattice}, which gives us a whole class of new machinery to work with. The rank of $\NS(X)$ is called the \emph{Picard number} of $X$, and is written $\rho(X)$.
For a complex $K3$ surface, we in fact have the following neat result.
\begin{proposition}
For $X$ a complex $K3$ surface, the cohomology group $H^2(X,\ZZ)$ endowed with intersection form given by the cup product is isomorphic to a combination of $E_8$s and hyperbolic planes
\[
H^2(X,\ZZ)\cong E_8(-1)\oplus E_8(-1)\oplus U\oplus U\oplus U.
\]
\end{proposition}
\begin{proof}
See \cite{huybrechts}, Proposition 1.3.5.
\end{proof}
\noindent This isomorphism is useful in the it gives us an idea of what $H^2$ looks like, but is not useful in that there is no general way to identify a 2-cocycle with an element of the lattice.
\begin{proposition}
For $X$ a K3 surface over a field $k$, we have isomorphisms:
\[
\Pic(X)\cong\NS(X)\cong\Num(X).
\]
Furthermore, the natural intersection form on any of these is nondegenerate, even, and of signature $(1,\rho(X)-1)$.
\end{proposition}
\begin{proof}
See \cite{huybrechts}, Proposition 1.2.4.
\end{proof}

\section{Some invariants of K3 surfaces}
In this section, $X$ denotes an algebraic K3 surface over $\CC$. We will be computing the so-called ``Hodge diamond" of $X$. Hodge diamonds are common invariants used to classify varieties in complex geometry, and so we present one such diamond here. It is notable that these are in general analytic objects, and so one would not expect to be able to apply the algebraic cohomology theories. That we are able to do this is the focus of Serre's so-called GAGA paper, \cite{gaga}. In this paper, he shows that for algebraic varieties over algebraically closed fields, there are corresponding analytic objects that preserve some of the cohomological structure. This is remarkable because in the analytic setting, the cohomology theory is de Rham cohomology, which is a much finer cohomology than the Zariski topology. In our case, we can associate to $X$ the analytic space $X^{\text{an}}$, and have the following isomorphisms for all $i$:
\[
H^i(X^{\text{an}},\calO_{X^{\text{an}}})\cong H^i(X,\calO_X).
\] We adopt the following standard notation that is useful in relating the cohomological invariants of $X$. For nonnegative integers $p,q$, set
\begin{align*}
h^{p,q}(X)&=\dim_k H^q(X,\Omega_X^p).
\end{align*}
\noindent The dimension above is vector space dimension, and for $p=0$ we take $\Omega_X^0=\calO_X$. For K3 surfaces, we have $h^{0,0}(X)=1, h^{0,1}(X)=0.$ Further, we have from Serre duality the following isomorphism:
\[
H^2(X,\calO_X)\cong H^0(X,\Omega_X^2)^*,
\]
and since $\Omega_X^2=\omega_X\cong\calO_X$ this re-writes to
\[
H^2(X,\calO_X)\cong H^0(X,\calO_X)^*.
\]
We know that $\dim_kH^0(X,\calO_X)=1$, and then since duals of finite-dimensional vector spaces have the same dimension as the original space, we get $\dim_k( H^0(X,\calO_X)^*)=1$. Thus, $h^{2,0}(X)=1$. Serre duality also gives $h^{0,2}(X)=1, h^{1,0}(X)=h^{1,2}(X)=h^{2,1}(X)=0, h^{2,2}=1$. Computing $h^{1,1}(X)$ is less straightforward, and requires the Hirzebruch-Riemann-Roch theorem as well as Noether's formula. These two powerful results give that $h^{1,1}(X)=20$. In sum, we have the \emph{Hodge diamond} for K3 surfaces
\[
\begin{matrix}
& & h^{0,0} & & \\
& h^{1,0} & & h^{0,1}&\\
h^{2,0} & &h^{1,1} & & h^{0,2}\\
& h^{1,2} & & h^{2,1} &\\
& & h^{2,2} & &
\end{matrix}
\hspace{1in}
\begin{matrix}
& & 1 & & \\
& 0 & & 0 &\\
1 & & 20 & & 1\\
& 0 & & 0 &\\
& & 1 & &
\end{matrix}
\]
\section{Finding elements of the geometric Picard lattice}
Finding explicit divisors on any variety depends on the equations defining the variety, so the methods used vary greatly from variety to variety. Because of this, we start by discussing a way to obtain  additional divisors given that we already have some to work with.

Let $X$ be a K3 surface defined over a number field $k$. Fix an embedding of $k$ into $\CC$, and define $\overline{X}=X_\CC$. This $\overline{X}$ is a K3 surface over $\CC$. Because of this, we can apply the following theorem.
\begin{theorem} Let $Y$ be a complex K3 surface. Then the following statements hold.
\begin{enumerate}
\item The cohomology group $H^2(Y,\ZZ)$ endowed with the cup product is isomorphic to the K3 lattice $\Lambda_{\text{K3}}$:
\[
H^2(Y,\ZZ)\cong\Lambda_{\text{K3}}\cong E_8(-1)^{\oplus2}\oplus U^{\oplus3}.
\]
\item There is a primitive embedding of lattices $\Pic Y\hookrightarrow H^2(Y,\ZZ)$, and the image of this embedding is $H^2(Y,\ZZ)\cap H^{1,1}(Y)$.
\item $\rho(Y)\leq20$.
\item Given another complex K3 surface $Y'$ and a dominant rational map $Y'\dashrightarrow Y$, we have $\rho(Y')=\rho(Y')$.
\end{enumerate}
\end{theorem}
\begin{proof}
See \cite{festiThesis}, Theorem 1.2.36.
\end{proof}
\noindent In the above theorem, \emph{primitive embedding} means that the cokernel of the injection is torsion-free. In order to see how this theorem is useful, we need some heavy machinery coming from Hodge theory, the details of which are beyond the scope of this thesis. 
\begin{definition}
Given two complex K3 surfaces $Y,Z$, a lattice homomorphism $\phi:H^2(Z,\ZZ)\to H^2(Y,\ZZ)$ is called a \emph{Hodge isometry} if it preserves the lattice pairing on $H^2(Z,\ZZ)$, and its $\CC$-linear extension $\phi_\CC$ preserves the Hodge structures, which is to say $\phi_\CC(H^{p,q}(Z))=H^{p,q}(Y)$. A Hodge isometry is \emph{effective} if it sends ample classes to ample classes.
\end{definition}
\begin{proposition}
Suppose we have an isomorphism $f: Y\to Z$ of complex K3 surfaces. Then the lattice homomorphism $f^*:H^2(Z,\ZZ)\to H^2(Y,\ZZ)$ obtained from the pullback is an effective Hodge isometry.
\end{proposition}
\begin{proof}
See \cite{festiThesis} Proposition 1.2.41.
\end{proof}
 The converse of this result is a major result for the theory of K3 surfaces, known as the Torelli theorem.
\begin{theorem}
Given complex K3 surfaces $Y,Z$ and an effective Hodge isometry $\phi:H^2(Z,\ZZ)\to H^2(Y,\ZZ)$, there is a unique isomorphism $f:Y\to Z$ such that $\phi=f^*$.
\end{theorem}
\begin{proof}
See \cite{vanDeVen}, Theorem VIII.11.1 and Corollary VIII.11.4.
\end{proof}
\noindent This theorem establishes a 1 to 1 correspondence between the effective Hodge isometries of $H^2(\overline{X},\ZZ)$ and the automorphisms of $\overline{X}$. Indeed, for $f$ an automorphism of $\overline{X}$, we get an isometry $\phi=f^*$ of $\Pic\overline{X}$. Thus, given a divisor class in $\Pic\overline{X}$, we will be able to obtain different classes via automorphisms of $\overline{X}$. 
\section{A worked example}
In this section we will be looking at a K3 surface that is a double cover of the projective plane branched along a smooth sextic. We should verify that any such surface over a field of characteristic different from 2 is in fact a K3. 

Suppose that $k$ is a field not of characteristic 2. Let $X$ be a double cover of $\Proj^2_k$ branched along a smooth sextic curve $C\subseteq\Proj^2_k$, and let $\pi:X\to\Proj^2_k$ be the covering map. Since $\pi$ has degree 2 and $C$ has degree 6, we know that we can find an invertible sheaf $\calL\cong\calO_{\Proj^2_k}(3)$ such that $\calL^2\cong\calO_{\Proj^2_k}(C)=\calO_{\Proj^2_k}(6)$. Then, the Riemann-Hurwitz formula, which can be found in \cite{vanDeVen}, Lemma I.17.1, we compute $\omega_X$:
\[
\omega_X\cong\pi^*(\omega_{\Proj^2_k}\otimes\calL)\cong\pi^*(\calO_{\Proj^2_k}(-3)\otimes\calO_{\Proj^2_k}(3))\cong\pi^*(\calO_{\Proj^2_k})\cong\calO_X.
\]
\noindent So, we have that $X$ has trivial canonical sheaf. Then, \cite{vanDeVen} Lemma I.17.2 gives
\[
\pi_*\omega_X\cong\pi_*\calO_X\cong\calL^0\oplus\calL^{-1}\cong\calO_{\Proj^2_k}\oplus\calO_{\Proj^2_k}(-3).
\]
Since $\pi$ is a finite morphism, $\pi_*$ is exact, so we get $H^1(X,\calO_X)\cong H^1(\Proj^2_k,\pi_*\calO_X)$. Now, since $\Proj^2_k$ is a Noetherian topological space, cohomology commutes with direct sums (this is Proposition III.2.9 in \cite{hartshorne}), so 
\[
H^1(\Proj^2_k,\pi_*\calO_X)=H^1(\Proj^2_k,\calO_{\Proj^2_k}\oplus\calO_{\Proj^2_k}(-3))\cong H^1(\Proj^2_k,\calO_{\Proj^2_k})\oplus H^1(\Proj^2_k,\calO_{\Proj^2_k}(-3)).
\]
Each of these first cohomology groups vanishes by \cite{hartshorne} Theorem III.5.1, so we have the desired vanishing, $H^1(X,\calO_X)=0$.

Thus, as long as the base field $k$ is not of characteristic 2, we can define K3 surfaces using these double covers. Define the weighted projective space over the rationals
\[
\Proj:=\Proj_\QQ(1,1,1,3)
\]
with coordinates $x,y,z,w$ having weights $1,1,1,3$ respectively. Then, let $X$ be the variety defined by 
\[
X:\hspace{0.25cm} w^2=x^6+y^6+z^6
\]
in $\Proj$. This is a surface, and moreover it is one of the K3 surfaces just defined, since $x^6+y^6+z^6$ is a smooth curve, and the $w^2$ gives us the desired double cover. Our goal is to find divisors on this surface, and one way to do this is to project $X$ to a different surface, and then pull back. We define a map
\begin{align*}
\pi:\Proj_\QQ(1,1,1,3)&\to\Proj_\QQ(1,1,2,3)\\
(x,y,z,w)&\mapsto(x,y,z^2,w).
\end{align*}
This map restricted to $X$ induces a double cover of the surface $\widetilde{X}$ in $\Proj_\QQ(1,1,2,3)$ defined by
\[
\widetilde{X}:\hspace{0.25cm} w^2=x^6+y^6+z^3.
\]
We take for granted that $\widetilde{X}$ is a del Pezzo surface of degree 1, and the details of this can be found in \cite{tonyThesis}. We have the following result about exceptional divisors on $\widetilde{X}$.
\begin{theorem}[Theorem 1.5.9 in \cite{tonyThesis}]
Let $Y$ be a del Pezzo surface of degree 1 over a field $k$, given as a smooth sextic hypersurface $V(f(x,y,z,w))$ in $\Proj_k(1,1,2,3)$. Let
\[
\Gamma=V(z-Q(x,y),w-C(x,y))\subseteq\Proj_{k^s}(1,1,2,3),
\]
for $Q$ a homogeneous form of degree 2 in $x$ and $y$, $C$ a homogeneous form of degree 3 in $x$ and $y$. If $\Gamma$ is a divisor on $Y_{k^s}$, then it is an exceptional curve of $Y$. Conversely, every exceptional curve on $Y$ is a divisor of this form.
\end{theorem}
\begin{proof}
This is section 4.1.3 of \cite{tonyThesis}.
\end{proof}
\noindent In the statement of the above theorem, an exceptional curve refers to a curve on a surface with self-intersection $-1$.

In order to find the possible divisors $\Gamma$ on our $\widetilde{X}$, we proceed as follows, following \cite{tonyThesis}. We know that $Q$ and $C$ take the following forms:
\[
Q(x,y)=ax^2+bxy+cy^2,\hspace{0.5cm} C(x,y)=rx^3+sx^2y+txy^2+uy^3,
\]
for $a,b,c,r,s,t,u\in\QQ$, and that
\[
C(x,y)^2=Q(x,y)^3+x^6+y^6.
\]
Substituting the forms for $Q,C$ into the above display, we compare coefficients to get a system of equations
\begin{align*}
u^2-c^3-1&=0,\\
2tu-3c^2b&=0,\\
2su+t^2-3ac^2-3cb^2&=0,\\
2ru+2st-6acb-b^3&=0,\\
2rt+x^2-3a^2c-3ab^2&=0,\\
2rs-3a^2b&=0,\\
r^2-a^3-1&=0.
\end{align*}
Considering $a,b,c,r,s,t,u$ as indeterminates over $\QQ$, we use Magma to compute a Gr\"obner basis for the ideal generated by the above 7 polynomials with respect to the lexicographic ordering induced by setting $r>s>t>u>a>b>c$. By design, the last element of this Gr\"obner basis is a polynomial only in $c$, which admits the factorization:
\[
(c+1)(c^2-c+1)(c^2+2c+4)(c^3+4)(c^3+6c^2+4)(c^6-6c^5+36c^4+8c^3-24c^2+16).
\]
The roots here are the possible values of $c$ as the coefficient of $y^2$ in $Q(x,y)$. Plugging each possible value of $c$ into the above system of equations and solving yields 240 distinct tuples $(r,s,t,u,a,b,c)$. Each of these tuples defines an exceptional curve on $\widetilde{X}_{\overline{\QQ}}$, and it is known that degree 1 del Pezzo surfaces have 240 exceptional curves, so this is good. 

Furthermore, it is known that the rank of the geometric Picard lattice of a degree 1 del Pezzo surface has rank 9, so if we can find 9 exceptional curves $E_1,\ldots, E_9$, we will be able to generate the geometric Picard lattice of this del Pezzo surface. The pullbacks of these generators $\pi^*E_1,\ldots\pi^*E_9$ will be linearly independent divisors on $X_{\overline{\QQ}}$, and from that point we can let the automorphisms of $\Pic(X_{\overline{\QQ}})$ induced by automorphisms of $X$ act on these 9 divisors to obtain more linearly independent divisors.
\backmatter 
%\nocite{*}

\bibliographystyle{alpha}
\bibliography{thesis}

\end{document}
